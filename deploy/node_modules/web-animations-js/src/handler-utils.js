(function(scope){function consumeToken(regex,string){var result=regex.exec(string);if(result){result=regex.ignoreCase?result[0].toLowerCase():result[0];return[result,string.substr(result.length)]}}function consumeTrimmed(consumer,string){string=string.replace(/^\s*/,"");var result=consumer(string);if(result){return[result[0],result[1].replace(/^\s*/,"")]}}function consumeRepeated(consumer,separator,string){consumer=consumeTrimmed.bind(null,consumer);var list=[];while(!0){var result=consumer(string);if(!result){return[list,string]}list.push(result[0]);string=result[1];result=consumeToken(separator,string);if(!result||""==result[1]){return[list,string]}string=result[1]}}function consumeParenthesised(parser,string){for(var nesting=0,n=0;n<string.length;n++){if(/\s|,/.test(string[n])&&0==nesting){break}else if("("==string[n]){nesting++}else if(")"==string[n]){nesting--;if(0==nesting)n++;if(0>=nesting)break}}var parsed=parser(string.substr(0,n));return parsed==void 0?void 0:[parsed,string.substr(n)]}function lcm(a,b){var c=a,d=b;while(c&&d)c>d?c%=d:d%=c;c=a*b/(c+d);return c}function ignore(value){return function(input){var result=value(input);if(result)result[0]=void 0;return result}}function optional(value,defaultValue){return function(input){var result=value(input);if(result)return result;return[defaultValue,input]}}function consumeList(list,input){for(var output=[],i=0,result;i<list.length;i++){result=scope.consumeTrimmed(list[i],input);if(!result||""==result[0])return;if(result[0]!==void 0)output.push(result[0]);input=result[1]}if(""==input){return output}}function mergeWrappedNestedRepeated(wrap,nestedMerge,separator,left,right){for(var matchingLeft=[],matchingRight=[],reconsititution=[],length=lcm(left.length,right.length),i=0,thing;i<length;i++){thing=nestedMerge(left[i%left.length],right[i%right.length]);if(!thing){return}matchingLeft.push(thing[0]);matchingRight.push(thing[1]);reconsititution.push(thing[2])}return[matchingLeft,matchingRight,function(positions){var result=positions.map(function(position,i){return reconsititution[i](position)}).join(separator);return wrap?wrap(result):result}]}function mergeList(left,right,list){for(var lefts=[],rights=[],functions=[],j=0,i=0;i<list.length;i++){if("function"==typeof list[i]){var result=list[i](left[j],right[j++]);lefts.push(result[0]);rights.push(result[1]);functions.push(result[2])}else{(function(pos){lefts.push(!1);rights.push(!1);functions.push(function(){return list[pos]})})(i)}}return[lefts,rights,function(results){for(var result="",i=0;i<results.length;i++){result+=functions[i](results[i])}return result}]}scope.consumeToken=consumeToken;scope.consumeTrimmed=consumeTrimmed;scope.consumeRepeated=consumeRepeated;scope.consumeParenthesised=consumeParenthesised;scope.ignore=ignore;scope.optional=optional;scope.consumeList=consumeList;scope.mergeNestedRepeated=mergeWrappedNestedRepeated.bind(null,null);scope.mergeWrappedNestedRepeated=mergeWrappedNestedRepeated;scope.mergeList=mergeList})(webAnimations1);